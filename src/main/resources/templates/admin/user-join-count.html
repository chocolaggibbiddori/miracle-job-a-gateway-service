<!doctype html>
<html
        xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout" xmlns="http://www.w3.org/1999/html"
        layout:decorate="~{layout/default_layout}" lang="ko">

<div layout:fragment="content">
    <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
    <script type="text/javascript" th:inline="javascript">
        google.charts.load('current', {packages: ['corechart', 'line']});
        google.charts.setOnLoadCallback(drawChart);

        google.charts.setOnLoadCallback(drawChart);

        function drawChart() {
            /*<![CDATA[*/
            var chartData = /*[[${chartData}]]*/ null;
            /*]]>*/

            console.log(chartData);

            if (chartData) {
                var data = new google.visualization.DataTable();
                data.addColumn('string', 'Month');
                data.addColumn('number', 'User');

                var dataArray = [];
                for (var key in chartData) {
                    if (chartData.hasOwnProperty(key)) {
                        dataArray.push([key, chartData[key]]);
                    }
                }

                data.addRows(dataArray);

                var options = {
                    title: 'Monthly User Join Count',
                    hAxis: {
                        title: 'Month'
                    },
                    vAxis: {
                        title: 'the number of persons',
                        minValue: 0
                    }
                };

                var chart = new google.visualization.LineChart(document.getElementById('chart_div'));
                chart.draw(data, options);
            } else {
                console.error('chartData is null or undefined');
            }
        }
    </script>
    <main>
        <header class="site-header d-flex flex-column justify-content-center align-items-center">
        </header>

        <section class="latest-podcast-section" id="section_2">
            <div class="container">
                <div class="row justify-content-center">
                    <!-- 전체 박스 크기 -->
                    <div class="col-lg-9 col-12">
                        <div class="section-title-wrap mb-3">
                            <h4 class="section-title">월별 유저 가입 회원 수</h4>
                        </div>

                        <div class="row justify-content-center">
                                <div class="card p-2 my-3 col-6 post-form align-self-center bg-white" style="width: 800px; height: 500px;" id="chart_div"></div>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    </main>
</div>

</html>
