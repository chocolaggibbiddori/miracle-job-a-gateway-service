<!doctype html>
<html
        xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout" xmlns="http://www.w3.org/1999/html"
        layout:decorate="~{layout/default_layout}" lang="ko">

<div layout:fragment="content">
    <script th:inline="javascript">
        /* 전화번호 정규식 */
        window.onload = function() {
            /* 전화번호 정규식 */
            function onInputPhone(input) {
                if (input.id === 'phone') {
                    var phone = input.value;
                    input.value = phone.replace(/(\d{3})(\d{4})(\d{4})/, '$1-$2-$3');
                }
            }

            // 처음에 들어온 값을 적용하기 위해
            var phoneElement = document.getElementById('phone');
            if (phoneElement) {
                phoneElement.value = phoneElement.value.replace(/(\d{3})(\d{4})(\d{4})/, '$1-$2-$3');
            }
        }


        // 처음에 들어온 값을 적용하기 위해
        document.getElementById('phone').value = document.getElementById('phone').value.replace(/(\d{3})(\d{3})(\d{4})/, '$1-$2-$3');


        // 수정취소 (상세보기로 돌아가기)
        function cancelEditing(button) {
            var resumeId = button.getAttribute('data-delete-id');
            var confirmResult = confirm("수정 취소 하시겠습니까?")

            if (confirmResult){
                window.location.href = '/v1/user/resume/detail/' + resumeId;
            } else {

            }
        }

        // 뒤로가기
        function goBack() {
            window.history.back();
        }

    function enableEditing(){

        $('#cancelBtn ').css('display', 'block');
        $('#submitBtn').css('display', 'block');

        $('#editBtn').css('display', 'none');
        $('#back').css('display', 'none');

        var pwdDiv = document.getElementById("pwd");
        var passwordInput = document.getElementById("password");
        var confirmPwdInput = document.getElementById("confirmPwd");

        if (pwdDiv.style.display === "none") {
            // 숨겨진 경우 나타내기
            pwdDiv.style.display = "block";
            passwordInput.style.display = "block";
            confirmPwdInput.style.display = "block";
        } else {
            // 나타난 경우 숨기기
            pwdDiv.style.display = "none";
            passwordInput.style.display = "none";
            confirmPwdInput.style.display = "none";
        }

    }

        function validateSpecialCharacters() {
            var inputValues = [
                document.getElementById('email').value,
                document.getElementById('birth').value,
                document.getElementById('phone').value,
                document.getElementById('address').value,
            ];

            for (var i = 0; i < inputValues.length; i++) {
                if (inputValues[i].includes('<') || inputValues[i].includes('>') || inputValues[i].includes(';')
                    || inputValues[i].includes('/') || inputValues[i].includes('\\')) {
                    // 특수 문자가 포함된 경우 경고 메시지 표시하고 false 반환
                    alert('입력란에 >, <, ;, /, \\, 특수기호는 입력할 수 없습니다.');
                    return false;
                }
            }

            return true;
        }

        function validateForm(){

            // 빈칸 경고
            var careerInput = document.getElementById('email');
            if (careerInput.value.trim() === '') {
                alert('이메일 입력이 필요합니다.');
                event.preventDefault();
                return false;
            }

            var careerInput = document.getElementById('phone');
            if (careerInput.value.trim() === '') {
                alert('전화번호 입력이 필요합니다.');
                event.preventDefault();
                return false;
            }

            var careerInput = document.getElementById('birth');
            if (careerInput.value.trim() === '') {
                alert('생년월일 입력이 필요합니다.');
                event.preventDefault();
                return false;
            }

            var careerInput = document.getElementById('address');
            if (careerInput.value.trim() === '') {
                alert('주소 입력이 필요합니다.');
                event.preventDefault();
                return false;
            }




            if (!validateSpecialCharacters()) {
                event.preventDefault();
                return false;
            }

            // 모든 조건이 충족되면 true 반환
            return true;

        }


    </script>

    <main>
        <header class="site-header d-flex flex-column justify-content-center align-items-center">
        </header>

        <section class="latest-podcast-section" id="section_2">
            <div class="container">
                <div class="row justify-content-center">
                    <!-- 전체 박스 크기 -->
                    <div class="col-lg-9 col-12">
                        <div class="section-title-wrap mb-3">
                            <h4 class="section-title">개인정보</h4>
                        </div>

                        <div class="row justify-content-center">
                            <div class="row ">
                                <div class="col-lg-3 col-12">
                                    <div class="custom-block-icon-wrap">
                                        <div class="custom-block-image-wrap custom-block-image-detail-page">
                                            <img src="/images/niniz.png" class="custom-block-image img-fluid" alt="">
                                        </div>
                                    </div>
                                </div>

                                <div class="col-lg-9 col-12 ">
                                    <div class="custom-block-info post-form">

                                        <div class="col-10 mt-4 mx-auto">
                                            <h2 class="mb-2 " th:text="${info.name}">Kakao</h2>
                                        </div>

                                        <div class="col-10 mt-3 mx-auto">
                                            <label>생년월일</label>
                                            <input type="date" readonly class="form-control mt-2" id="birth" name="birth" th:value="${info.birth}">
                                        </div>

                                        <div class="col-10 mt-3 mx-auto">
                                            <label>전화번호</label>
                                            <input type="text" readonly class="form-control mt-2" id="phone" name="phone" th:value="${info.phone}" oninput="onInputPhone(this)" />
                                        </div>

                                        <div class="col-10 mt-3 mx-auto">
                                            <label>주소</label>
                                            <input type="text" readonly class="form-control-plaintext mt-2" id="address" name="address" th:value="${info.address}">
                                        </div>

                                        <div class="col-10 mt-3 mx-auto">
                                            <label for="stack">보유한 기술 스택</label>
                                            <div class="card mt-2 mb-4 p-4 col-11 post-form align-self-center">
                                                <div th:each="stacks : ${stack}">
                                                    <span id="bi-person-workspace" th:text="${stacks.name}"></span>
                                                </div>
                                            </div>
                                        </div>


                                        <div class="row col-12 my-5">
                                            <div class="col-4">
                                                <button type="button" class="form-control" id="back" onclick="goBack()">돌아가기</button>
                                                <button type="button" class="form-control" id="cancelBtn" onclick="cancelEditing(this)" style="display: none">수정취소</button>
                                            </div>
                                            <div class="col-4">

                                            </div>
                                            <div class="col-4">
                                                <button type="button" class="form-control" id="editBtn" onclick="enableEditing()">정보수정</button>
                                                <button type="submit" class="form-control" id="submitBtn" onclick="validateForm()" style="display: none">수정완료</button>
                                            </div>
                                        </div>


                                    </div>
                                </div>
                            </div>

                        </div>
                    </div>

                </div>
            </div>
        </section>
    </main>
</div>

</html>
