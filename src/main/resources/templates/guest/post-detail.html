<!doctype html>
<html
        xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout" xmlns="http://www.w3.org/1999/html"
        layout:decorate="~{layout/default_layout}" lang="ko">

<div layout:fragment="content">
    <style>
        /* CSS */
        .modal-backdrop-dark {
            position: fixed;
            top: 0;
            right: 0;
            bottom: 0;
            left: 0;
            background-color: rgba(0, 0, 0, 0.5); /* 어두운 배경 색상 */
            z-index: 1040; /* 모달보다 앞에 위치하도록 z-index 설정 */
        }
    </style>
    <script>
        function loginform() {
            var page = [[${postId}]]
            location.href = "/v1/user/login-form?page=" + page;
        }

        function validateForm() {
            //TODO 이력서, 자소서 번호 넘기는 거를 해야 함
            return confirm(`지원하시겠습니까? 한번 지원하면 더 지원이 불가능합니다.
올바른 이력서와 자소서를 입력하셨는지 확인바랍니다.`);
        }
    </script>
    <main>
        <header class="site-header d-flex flex-column justify-content-center align-items-center">
        </header>

        <section class="latest-podcast-section" id="section_2">
            <div class="container">
                <div class="section-title-wrap mb-5">
                    <h4 class="section-title" th:text="${detail.title}"></h4>
                </div>
                <div class="row justify-content-center">
                    <!-- 박스 시작 -->
                    <div class="card bg-outline-light bg-transparent text-dark shadow-lg post-form col-12">
                        <div class="row post-form col-10">
                            <div class="card-body align-self-center">
                                <div class="row">
                                    <div class="col-4 mt-2 ">
                                        <div class="mb-1">
                                            <label for="endDate">마감일</label>
                                        </div>
                                        <input type="datetime-local" name="endDate" id="endDate"
                                               class="form-control" placeholder="마감일" th:value="${detail.endDate}"
                                               readonly required/>
                                    </div>
                                    <div class="col-4 mt-2">
                                        <div class="mb-1">
                                            <label for="career">경력</label>
                                        </div>
                                        <input type="number" name="career" id="career" class="form-control"
                                               placeholder="경력(년)" th:value="${detail.career}" readonly
                                               oninput="this.value = this.value.replace(/[^0-9.]/g, '').replace(/(\..*)\./g, '$1');"/>
                                    </div>
                                </div>


                                <div class="col-8 mt-2">
                                    <div class="mb-1">
                                        <label for="jobId">직무</label>
                                    </div>
                                    <div th:if="${jobs != null}">
                                        <div th:each="job : ${jobs}" id="jobs" style="display: inline-block;">
                                            <label class="form-check-label bi-person-workspace"
                                                   th:text="'  '+${job.name}"></label>
                                            <br/>
                                        </div>
                                    </div>
                                </div>


                                <div class="col-8 mt-2">
                                    <div class="mb-1">
                                        <label for="stackId">요구스택</label>
                                    </div>
                                    <div th:if="${stacks != null}">
                                        <div th:each="stack : ${stacks}" id="stacks" style="display: inline-block;">
                                            <label class="form-check-label bi-view-stacked"
                                                   th:text="'  '+${stack.name}"></label>
                                            <br/>
                                        </div>
                                    </div>

                                </div>


                                <div class="col-8 mt-4">
                                    <h4 class="mb-2">회사 정보</h4>
                                    <!--
                                     회사명 : name
                                     대표자 : ceoName
                                     재직인원 : employeeNum
                                     근무주소(디폴트 회사 주소) : address
                                     사진 : photo
                                     -->
                                    <div class="row">
                                        <div class="col-4 mt-2">
                                            <div class="mb-1">
                                                <label for="name">회사명</label>
                                            </div>
                                            <input type="text" name="name" id="name" th:value="${info.name}"
                                                   class="form-control" placeholder="회사명" disabled/>
                                        </div>
                                        <div class="col-4 mt-2">
                                            <div class="mb-1">
                                                <label for="ceoName">대표자명</label>
                                            </div>
                                            <input type="text" name="ceoName" id="ceoName" th:value="${info.ceoName}"
                                                   class="form-control" placeholder="대표자명" disabled/>
                                        </div>
                                        <div class="col-4 mt-2">
                                            <div class="mb-1">
                                                <label for="employeeNum">재직인원</label>
                                            </div>
                                            <input type="number" name="employeeNum" id="employeeNum"
                                                   th:value="${info.employeeNum}"
                                                   class="form-control" placeholder="재직인원" disabled
                                                   oninput="this.value = this.value.replace(/[^0-9.]/g, '').replace(/(\..*)\./g, '$1');"/>
                                        </div>

                                        <div class="col-8 mt-2">
                                            <div class="mb-1">
                                                <label for="photo">기업사진</label>
                                            </div>
                                            <input type="text" name="photo" id="photo" th:value="${info.photo}"
                                                   class="form-control" placeholder="기업사진" disabled/>
                                        </div>
                                    </div>

                                </div>

                                <h5 class="mb-4 mt-4">소개</h5>
                                <!--
                                    기업소개(기업테이블) : introduction
                                    주요업무 : mainTask
                                    근무조건 : workCondition
                                    자격요건 : qualification
                                    개발 툴 : tool
                                    복지 및 혜택 : benefit
                                    우대 기술사항 : special_skill
                                    채용절차 : process
                                    유의사항 : notice

                                -->
                                <div class="col-8 mt-2">
                                    <div class="mb-1">
                                        <label for="introduction">기업소개</label>
                                    </div>
                                    <textarea class="form-control" rows="3" id="introduction" name="introduction"
                                              th:value="${info.introduction}" th:text="${info.introduction}"
                                              readonly></textarea>
                                </div>
                                <div class="col-8 mt-2">
                                    <div class="mb-1">
                                        <label for="mainTask">주요업무</label>
                                    </div>
                                    <textarea class="form-control" rows="3" id="mainTask" name="mainTask"
                                              th:text="${detail.mainTask}" readonly></textarea>
                                </div>
                                <div class="col-8 mt-2">
                                    <div class="mb-1">
                                        <label for="workCondition">근무조건</label>
                                    </div>
                                    <textarea class="form-control" rows="3" id="workCondition"
                                              name="workCondition" th:text="${detail.workCondition}"
                                              readonly></textarea>
                                </div>
                                <div class="col-8 mt-2">
                                    <div class="mb-1">
                                        <label for="qualification">자격요건</label>
                                    </div>
                                    <textarea class="form-control" rows="3" id="qualification"
                                              name="qualification" th:text="${detail.qualification}"
                                              readonly></textarea>
                                </div>
                                <div class="col-8 mt-2">
                                    <div class="mb-1">
                                        <label for="tool">개발 툴</label>
                                        <input type="text" name="tool" id="tool"
                                               class="form-control" th:value="${detail.tool}" readonly/>
                                    </div>
                                </div>
                                <div class="col-8 mt-2">
                                    <div class="mb-1">
                                        <label for="benefit">복지 및 혜택</label>
                                    </div>
                                    <textarea class="form-control" rows="3" id="benefit" name="benefit"
                                              th:text="${detail.benefit}" readonly></textarea>
                                </div>
                                <div class="col-8 mt-2">
                                    <div class="mb-1">
                                        <label for="special_skill">우대 기술사항</label>
                                    </div>
                                    <textarea class="form-control" rows="3" id="specialSkill"
                                              name="specialSkill" th:text="${detail.specialSkill}" readonly></textarea>
                                </div>
                                <div class="col-8 mt-2">
                                    <div class="mb-1">
                                        <label for="process">채용절차</label>
                                    </div>
                                    <textarea class="form-control" rows="3" id="process" name="process"
                                              th:text="${detail.process}" readonly></textarea>
                                </div>
                                <div class="col-8 mt-2">
                                    <div class="mb-1">
                                        <label for="notice">유의사항</label>
                                    </div>
                                    <textarea class="form-control" rows="3" id="notice" name="notice"
                                              th:text="${detail.notice}" readonly></textarea>
                                </div>
                                <div class="col-8 mt-2">
                                    <div class="mb-1">
                                        <label for="address">근무주소(세부주소 포함)</label>
                                    </div>
                                    <input type="text" name="workAddress" id="address"
                                           class="form-control mb-2" placeholder="근무주소" th:value="${detail.workAddress}"
                                           readonly/>
                                </div>
                                <div class="col-8 mt-2">
                                    <div class="form-floating">
                                        <button type="button" class="custom-btn" id="addressInputBtn"
                                                style="display: none">주소변경
                                        </button>
                                    </div>
                                </div>

                                <h5 class="mb-4 mt-4" style="display: inline-block;">자기소개서 질문</h5>
                                <br>

                                <div class="col-12 mb-4"
                                     th:each="question : ${detail.questionList}">
                                    <div>
                                        <input type="hidden" class="form-control" name="idList"
                                               th:value="${question.id}"/>
                                        <input type="text" th:id="'question' + ${question.id}" name="questionList"
                                               class="form-control" th:value="${question.question}" disabled/>
                                    </div>
                                </div>


                                <!-- Company_FAQ 의 질문(question) 컬럼명이 겹침 주의 ! -->
                                <h5 class="mb-4 mt-4">자주하는 질문</h5>
                                <div class="accordion" th:each="faq, faqStat : ${info.faqList}" id="accordionExample">
                                    <div class="accordion-item mb-3">
                                        <h2 class="accordion-header" th:id="'heading' + ${faqStat.index}">
                                            <button class="accordion-button collapsed rounded" type="button"
                                                    data-bs-toggle="collapse"
                                                    th:data-bs-target="'#collapse' + ${faqStat.index}"
                                                    aria-expanded="false"
                                                    th:aria-controls="'collapse' + ${faqStat.index}">
                                                <strong th:text="${faq.question}"></strong>
                                            </button>
                                        </h2>
                                        <div th:id="'collapse' + ${faqStat.index}" class="accordion-collapse collapse"
                                             th:aria-labelledby="'heading' + ${faqStat.index}">
                                            <div class="accordion-body">
                                                <strong th:text="${faq.answer}"></strong>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <div class="col-12 mt-5">
                                    <button type="button" class="form-control" onclick="loginform()"
                                            th:unless="${session.id}">
                                        로그인 후 지원하기
                                    </button>
                                    <button type="button" class="form-control" data-bs-toggle="modal"
                                            data-bs-target="#exampleModal" th:if="${session.id}">
                                        지원하기
                                    </button>
                                    <!-- Modal -->
                                    <form action="/v1/user/apply" id="modal" method="post"
                                          onsubmit="return validateForm()">
                                        <div class="modal modal-backdrop-dark" id="exampleModal" tabindex="-1"
                                             aria-labelledby="exampleModalLabel" aria-hidden="true"
                                             data-bs-backdrop="false">
                                            <div class="modal-dialog modal-dialog-centered modal-dialog-scrollable">
                                                <div class="modal-content">
                                                    <div class="modal-header">
                                                        <h5 class="modal-title" id="exampleModalLabel">지원서 정보 선택</h5>
                                                    </div>
                                                    <div class="modal-body container-fluid">
                                                        <div class="row align-self-center">
                                                            <div class="col-10 m-2 align-self-center"
                                                                 th:if="${resumeList!=null}">
                                                                <label for="resume">이력서를 선택해 주세요.</label>
                                                                <select class="form-select" name="resumeId" id="resume"
                                                                        aria-label="Default select example"
                                                                        th:each="resume : ${resumeList}" required>
                                                                    <option th:value="${resume.id}"
                                                                            th:text="${resume.title}"></option>
                                                                </select>
                                                                <p th:if="${#lists.size(resumeList)==0}">
                                                                    이력서가 존재하지 않습니다.
                                                                </p>
                                                            </div>
                                                            <div class="col-10 m-2 align-self-center"
                                                                 th:if="${coverLetterList!=null}">
                                                                <label for="coverLetter">지원서를 선택해 주세요.</label>

                                                                <select class="form-select" name="coverLetterId"
                                                                        id="coverLetter"
                                                                        aria-label="Default select example"
                                                                        th:each="coverLetter : ${coverLetterList}"
                                                                        required>
                                                                    <option th:value="${coverLetter.id}"
                                                                            th:text="${coverLetter.title}"></option>
                                                                </select>
                                                                <p th:if="${#lists.size(coverLetterList)==0}">
                                                                    자소서가 존재하지 않습니다.
                                                                </p>

                                                            </div>
                                                            <div class="col-10 m-2 align-self-center">
                                                                <a class="text-secondary">이 공고의 이력서, 자소서가 없다면 새로
                                                                    생성해주세요</a>
                                                                <button type="button" class="btn-outline-danger">이력서 작성
                                                                </button>
                                                                <button type="button" class="btn-outline-danger">자소서 작성
                                                                </button>
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <div class="modal-footer">
                                                        <button type="button" class="btn btn-secondary"
                                                                data-bs-dismiss="modal">취소
                                                        </button>
                                                        <input type="hidden" name="postType"
                                                               th:value="${detail.postType}"/>
                                                        <input type="hidden" name="userJob" th:value="${jobs[0].name}"/>
                                                        <input type="hidden" name="postId" th:value="${postId}"/>
                                                        <button type="submit" class="btn btn-primary">지원하기</button>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </form>
                                </div>
                            </div>
                        </div>

                    </div>
                    <!-- 박스 끗 -->
                </div>
            </div>
        </section>


    </main>
</div>

</html>